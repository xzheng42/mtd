# set model order
mtdorder <- 10
# fit the model
prior <- list(u_th = 2, v_th = 2, u_psi = 6, v_psi = 2, u_kap = 2, v_kap = 1,
alpha = 1, alpha_0 = 5, a_G0 = 1, b_G0 = 3)
starting <- list(kap = 2)
tuning <- list(se_kap = 0.15)
mcmc_param <- list(niter = 20000, nburn = 4000, nthin = 4)
res <- tsMTD(obs = obs, mtdorder = mtdorder, family = "negative binomial",
weight = "sb", prior = prior, tuning = tuning, starting = starting,
mcmc_param = mcmc_param)
library(mtd)
set.seed(42)
# set up parameters
mtdorder <- 5
expDecay <- function(x, la) exp(-la*x)
weight <- expDecay(1:mtdorder, 1)
weight <- weight / sum(weight)
param <- list(la = 5, ga = 3, kap = 3, eta = 2)
ndata <- 1000
# generate data
simu <- rMTD(mtdorder = mtdorder, weight = weight, family = "negative binomial",
param = param, size = ndata)
obs <- simu$y
plot(obs, type = "l", xlab = "Time", ylab = "Count", las = 1, ylim = c(0, 50))
# set model order
mtdorder <- 10
# fit the model
prior <- list(u_th = 2, v_th = 2, u_psi = 6, v_psi = 2, u_kap = 2, v_kap = 1,
alpha = 1, alpha_0 = 5, a_G0 = 1, b_G0 = 3)
starting <- list(kap = 2)
tuning <- list(se_kap = 0.15)
mcmc_param <- list(niter = 20000, nburn = 4000, nthin = 4)
res <- tsMTD(obs = obs, mtdorder = mtdorder, family = "negative binomial",
weight = "sb", prior = prior, tuning = tuning, starting = starting,
mcmc_param = mcmc_param)
# compute the interval
lags <- lagmat(obs, mtdorder)
trun_obs <- obs[-(1:mtdorder)]
probs <- c(0.025, 0.975)
pred_intv <- predMTD(res = res, family = "negative binomial", lags = lags, probs = probs)
dim(lags)
dim(res$weight)
devtools::load_all(".")
# compute the interval
lags <- lagmat(obs, mtdorder)
trun_obs <- obs[-(1:mtdorder)]
probs <- c(0.025, 0.975)
pred_intv <- predMTD(res = res, family = "negative binomial", lags = lags, probs = probs)
# plot
par(mar = c(5.1, 4.1, 3.1, 2.1), xpd = TRUE)
plot(trun_obs[1:600], xlab = "Time", ylab = "Count", ylim = c(0, 60), las = 1,
pch = 19, cex = 0.35)
lines(pred_intv[1, 1:600], col = "indianred2", lty = 2, lwd = 1.5)
lines(pred_intv[2, 1:600], col = "indianred2", lty = 2, lwd = 1.5)
legend("topleft", inset = c(0, -0.15), legend = c("observation", "95% predictive interval"),
pch = c(19, NA), lty = c(NA, 2), col = c("black", "indianred2"), bty = "n",
cex = 0.8, lwd = 2, horiz = TRUE)
devtools::load_all(".")
devtools::check()
usethis::use_github_actions()
usethis::use_github_actions()
usethis::use_github_actions()
